<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Stockist Dashboard - Pharma Distribution App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Core Principles for Mobile Dashboard CSS: */
        /* 1. Mobile-First Approach */
        /* 2. Flexbox & Grid for Layout */
        /* 3. Relative Units */
        /* 4. Minimalism & Clarity */
        /* 5. Touch Targets */
        /* 6. Performance */

        /* --- 1. Global Styles & Resets (Foundation) --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px; /* Define 1rem base */
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f0f2f5; /* Light gray background for the dashboard */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        h1, h2, h3, h4, h5, h6 {
            color: #1a202c;
            margin-bottom: 0.8rem;
            font-weight: 600;
        }

        h1 { font-size: 1.8rem; } /* Adjusted for mobile header */
        h2 { font-size: 1.6rem; }
        h3 { font-size: 1.3rem; }
        /* ... (and so on for other headings) */

        a {
            color: #007bff;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        a:hover {
            color: #0056b3;
        }

        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-thumb {
            background-color: #c9d0d9;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-track {
            background-color: #f0f2f5;
        }

        /* --- 2. Layout Structure (Flexbox for Mobile) --- */

        /* App Container - controls overall layout */
        .app-container {
            display: flex;
            flex-direction: column; /* Stack header and main content vertically on mobile */
            min-height: 100vh;
            padding: 0; /* Remove padding from app-container, add to sections */
        }

        /* Header */
        .header {
            background-color: #3498db;
            color: white;
            padding: 1rem; /* Adjust padding for mobile */
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 1.3rem; /* Smaller for mobile */
            margin: 0;
        }

        .user-info {
            font-size: 0.8rem; /* Smaller font size */
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            text-align: right;
        }

        .user-info strong, .user-info a {
            color: white;
        }
        .user-info a {
            text-decoration: underline;
        }

        /* Sidebar - Mobile Specific (Hidden by default, shown via JS for burger menu) */
        .sidebar {
            position: fixed;
            top: 0;
            left: -280px; /* Hidden off-screen */
            width: 250px;
            height: 100%;
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.2);
            transition: left 0.3s ease-in-out;
            z-index: 2000; /* Above everything else */
            overflow-y: auto; /* Scrollable if many items */
        }

        .sidebar.open {
            left: 0; /* Show sidebar */
        }

        .sidebar h2 {
            font-size: 1.5em;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 15px;
        }

        .sidebar ul {
            list-style-type: none;
            padding: 0;
        }

        .sidebar ul li a {
            display: flex; /* Use flex for icon and text alignment */
            align-items: center;
            color: white;
            padding: 12px 15px; /* Larger touch target */
            text-decoration: none;
            border-radius: 8px; /* Slightly more rounded */
            margin-bottom: 8px;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .sidebar ul li a i { /* Icon styling for sidebar */
            margin-right: 10px;
            font-size: 1.1rem;
        }

        .sidebar ul li a:hover, .sidebar ul li a.active {
            background-color: #3498db;
            box-shadow: 0 2px 5px rgba(0, 123, 255, 0.2);
        }

        /* Overlay for when sidebar is open */
        .overlay {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1999; /* Below sidebar, above content */
        }
        .overlay.active {
            display: block;
        }

        /* Burger Menu Icon for Mobile */
        .menu-toggle {
            background: none;
            border: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            display: block; /* Show on mobile */
        }

        /* Main Content Area */
        .main-content {
            flex-grow: 1;
            padding: 1rem; /* Overall padding for the main content */
        }

        .content-section {
            display: none;
            animation: fadeIn 0.5s ease-out; /* Simple fade-in effect */
        }
        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- 3. Dashboard Components (Cards & Elements) --- */

        /* Dashboard Container for BI Dashboard specific cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr; /* Single column for mobile BI dashboard */
            gap: 1.2rem; /* Space between cards */
            margin-top: 1.2rem;
        }

        /* Dashboard Card - General Styling */
        .dashboard-card, .card { /* Apply modern styling to both */
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            padding: 1.2rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: transform 0.2s ease-in-out;
            margin-bottom: 1.2rem; /* Ensure consistent spacing if not part of grid */
        }

        .dashboard-card:hover, .card:hover {
            transform: translateY(-3px);
        }

        .card-header {
            font-size: 1.1rem; /* Adjusted for card headers */
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 0.8rem;
            padding-bottom: 0.5rem; /* Reduced padding */
            border-bottom: 1px solid #eee;
            display: flex; /* For header actions if any */
            justify-content: space-between;
            align-items: center;
        }
        .card-header .info-icon {
            color: #888;
            font-size: 1rem;
            cursor: pointer;
            margin-left: 0.5rem;
        }

        /* Metric Card (e.g., total sales, new users) */
        .metric-card .main-metric {
            font-size: 2.2rem; /* Slightly smaller for mobile */
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 0.5rem;
        }

        .metric-card .metric-change {
            font-size: 0.9rem;
            font-weight: 500;
            display: flex;
            align-items: center;
        }

        .metric-card .metric-change.positive { color: #28a745; }
        .metric-card .metric-change.negative { color: #dc3545; }
        .metric-card .metric-change .icon { margin-right: 0.3rem; }
        .metric-card .metric-description {
            font-size: 0.8rem;
            color: #777;
            margin-top: 0.3rem;
        }

        /* Chart Card (e.g., bar, line, pie charts) */
        .chart-card .chart-container {
            height: 200px; /* Fixed height for charts on mobile */
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f8f9fa;
            border-radius: 5px;
            font-size: 0.9rem;
            color: #aaa;
        }

        /* List Card (e.g., top products, recent activities) */
        .list-card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .list-card li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.7rem 0;
            border-bottom: 1px solid #eee;
            font-size: 0.95rem;
            color: #444;
        }

        .list-card li:last-child {
            border-bottom: none;
        }

        .list-card .item-name {
            font-weight: 500;
        }

        .list-card .item-value {
            color: #007bff;
            font-weight: 600;
        }

        /* Alert/Notification Card */
        .alert-card {
            background-color: #fff3cd; /* Light yellow for warnings */
            border: 1px solid #ffeeba;
            color: #856404;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
            font-size: 0.9rem; /* Adjusted font size */
        }

        .alert-card.error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }

        .alert-card.success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }

        .alert-card .alert-icon {
            font-size: 1.2rem;
            margin-right: 0.8rem;
        }

        .alert-card p {
            margin: 0;
        }

        /* Filter Bar */
        .filter-bar {
            margin-bottom: 1.2rem;
            padding: 1rem;
            background-color: #ecf0f1;
            border-radius: 8px; /* More rounded */
            display: flex;
            flex-direction: column; /* Stack filters vertically on mobile */
            gap: 0.8rem; /* Space between filter elements */
            align-items: stretch; /* Stretch items to fill width */
        }
        .filter-bar input,
        .filter-bar select,
        .filter-bar button {
            width: 100%; /* Full width on mobile */
            padding: 0.7rem 1rem;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #fff;
            font-size: 0.9rem;
            color: #333;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
        .filter-bar select {
             background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23007bff%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13.6-6.4H18.8c-5%200-9.3%203.3-11.7%208.7-2.4%205.4-1.6%2011.6%202.1%2016.3l126.8%20126.9c3%203%207%204.7%2011.3%204.7s8.3-1.7%2011.3-4.7l126.8-126.9c3.8-4.7%204.5-10.9%202.1-16.3z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 0.7em top 50%, 0 0;
            background-size: 0.65em auto, 100%;
        }
        .filter-bar button {
            margin-top: 0.5rem; /* Add some space if it's not a direct input/select */
            margin-left: 0; /* Override previous margin */
        }
        .filter-bar .btn-sm { /* For specific small buttons within filter bar */
            padding: 0.6rem 1rem;
            font-size: 0.85rem;
        }

        /* Tables */
        .table-container {
            overflow-x: auto; /* Enable horizontal scrolling for tables */
            margin-top: 1.2rem; /* Space below filter or header */
            border-radius: 8px; /* Match card styling */
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); /* Subtle shadow */
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem; /* Slightly smaller font for tables */
            background-color: #ffffff;
            min-width: 600px; /* Ensure table is wide enough for content, allowing scroll */
        }

        th, td {
            border: 1px solid #eee; /* Lighter border */
            padding: 10px 12px; /* Adjusted padding */
            text-align: left;
        }

        th {
            background-color: #f8f8f8; /* Lighter header background */
            font-weight: 600;
            color: #555;
            position: sticky; /* Make headers sticky for horizontal scroll */
            top: 0;
            z-index: 1; /* Ensure headers are above scrolling content */
        }
        td {
            vertical-align: top; /* Align content to top in cells */
        }

        tr:nth-child(even) {
            background-color: #fbfbfb; /* Zebra striping */
        }
        tr:hover {
            background-color: #f0f8ff; /* Hover effect */
        }
        .action-buttons {
            display: flex;
            flex-wrap: wrap; /* Allow buttons to wrap on multiple lines */
            gap: 5px; /* Space between action buttons */
        }
        .action-buttons button, .action-buttons a {
            flex-shrink: 0; /* Prevent buttons from shrinking */
            margin-right: 0; /* Reset previous margin */
            margin-bottom: 0; /* Reset previous margin */
        }


        /* --- 4. Navigation (Bottom Nav for Mobile) --- */

        .bottom-nav {
            display: flex;
            justify-content: space-around;
            align-items: center;
            position: sticky;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #ffffff;
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.08); /* Stronger shadow */
            padding: 0.5rem 0;
            border-top-left-radius: 12px;
            border-top-right-radius: 12px;
            z-index: 1000;
            margin-top: 1rem;
        }

        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: #777;
            font-size: 0.7rem; /* Smaller font for text */
            padding: 0.5rem;
            flex: 1;
            transition: color 0.3s ease, transform 0.2s ease;
        }

        .bottom-nav-item i {
            font-size: 1.5rem; /* Larger icon for visibility */
            margin-bottom: 0.3rem;
        }

        .bottom-nav-item.active {
            color: #007bff;
            transform: translateY(-2px); /* Subtle lift for active item */
        }

        .bottom-nav-item:hover {
            color: #0056b3;
        }

        /* --- 5. Interactive Elements (Buttons, Inputs) --- */

        /* Buttons */
        .btn {
            padding: 0.8rem 1.4rem; /* Larger touch target */
            border-radius: 5px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.1s ease;
            border: 1px solid transparent;
            text-align: center; /* Ensure text is centered */
            display: inline-flex; /* Use flex for icon alignment if needed */
            align-items: center;
            justify-content: center;
        }

        .btn i { /* Icon inside button */
            margin-right: 0.5rem;
        }

        .btn:active {
            transform: translateY(1px); /* Click feedback */
        }

        .btn-primary { background-color: #007bff; color: #ffffff; border-color: #007bff; }
        .btn-primary:hover { background-color: #0056b3; border-color: #0056b3; }

        .btn-secondary { background-color: #6c757d; color: #ffffff; border-color: #6c757d; }
        .btn-secondary:hover { background-color: #5a6268; border-color: #545b62; }

        .btn-danger { background-color: #e74c3c; color: #ffffff; border-color: #e74c3c; }
        .btn-danger:hover { background-color: #c0392b; border-color: #ae3225; }

        .btn-success { background-color: #2ecc71; color: #ffffff; border-color: #2ecc71; }
        .btn-success:hover { background-color: #27ae60; border-color: #23a059; }

        .btn-outline {
            background-color: transparent;
            color: #007bff;
            border-color: #007bff;
        }

        .btn-outline:hover {
            background-color: #e6f2ff;
            color: #0056b3;
            border-color: #0056b3;
        }

        .btn-sm {
            padding: 0.6rem 1rem;
            font-size: 0.85rem;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: #555;
            font-weight: 600; /* Make labels bolder */
        }

        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group input[type="date"],
        .form-group input[type="password"],
        .form-group select,
        .form-group textarea {
            width: 100%; /* Full width */
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.95rem;
            color: #333;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            background-color: #fff;
        }
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            z-index: 2500; /* Higher than sidebar */
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6); /* Darker overlay */
            padding: 1rem; /* Padding for small screens */
        }
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto; /* Adjusted margin for mobile */
            padding: 1.5rem; /* Adjusted padding */
            border: 1px solid #888;
            width: 95%; /* Wider on mobile */
            max-width: 600px; /* Max width for larger screens */
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            animation: slideInTop 0.3s ease-out; /* Simple slide-in effect */
        }

        .modal-header {
            padding-bottom: 1rem;
            border-bottom: 1px solid #eee;
            margin-bottom: 1.2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-header h3 {
            margin: 0;
            font-size: 1.3rem; /* Adjusted for modal header */
            color: #1a202c;
        }
        .close-btn {
            color: #aaa;
            font-size: 2rem; /* Larger for better touch */
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        .close-btn:hover, .close-btn:focus {
            color: #333;
            text-decoration: none;
        }
        .modal-footer {
            margin-top: 1.5rem;
            display: flex;
            justify-content: flex-end; /* Align buttons to the right */
            gap: 0.8rem;
        }
        .modal-footer .btn {
            margin-right: 0; /* Reset button margin */
        }

        @keyframes slideInTop {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* --- Media Queries for Larger Screens (Tablets & Desktops) --- */
        @media (min-width: 768px) { /* Tablets and larger */
            h1 { font-size: 2rem; } /* Back to desktop size */
            .header {
                padding: 15px 20px;
            }
            .header h1 {
                font-size: 1.8em;
            }
            .user-info {
                font-size: 0.9em;
                flex-direction: row; /* Back to row layout */
                align-items: center;
            }
            .user-info a {
                margin-left: 10px; /* Space out logout link */
            }

            .menu-toggle {
                display: none; /* Hide burger menu on larger screens */
            }

            .app-container {
                flex-direction: row; /* Sidebar and main content side-by-side */
            }

            .sidebar {
                position: relative; /* Not fixed */
                left: 0; /* Always visible */
                width: 250px;
                box-shadow: none; /* No shadow needed */
                transition: none; /* No transition needed */
            }
            .overlay {
                display: none !important; /* Ensure overlay is hidden */
            }

            .main-content {
                padding: 1.5rem;
            }

            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr); /* Two columns for tablets */
                gap: 1.5rem;
            }
            .filter-bar {
                flex-direction: row; /* Row layout for filters */
                align-items: center;
                justify-content: flex-start;
                flex-wrap: wrap; /* Allow filters to wrap */
            }
            .filter-bar input,
            .filter-bar select {
                width: auto; /* Allow filters to size based on content */
                flex-grow: 1; /* Allow them to grow */
            }
            .filter-bar button {
                width: auto;
                margin-top: 0;
            }
            .filter-bar .btn-sm {
                margin-left: auto; /* Push "Export" button to the right */
            }

            .modal-content {
                margin: 10% auto; /* Centered margin for larger screens */
                width: 60%; /* Wider on larger screens */
            }
        }

        @media (min-width: 1024px) { /* Desktops */
            .main-content {
                padding: 2rem;
            }
            .dashboard-grid {
                grid-template-columns: repeat(3, 1fr); /* Three columns for desktops */
            }
            .header h1 {
                font-size: 2em;
            }
        }

        @media (min-width: 1440px) { /* Large Desktops */
            .dashboard-grid {
                grid-template-columns: repeat(4, 1fr); /* Four columns for large desktops */
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <button class="menu-toggle" aria-label="Open navigation menu">
            <i class="fas fa-bars"></i>
        </button>
        <h1>Pharma Distribution - Super Stockist</h1>
        <div class="user-info">
            Logged in as: <strong>StockistUser</strong>
            <a href="#logout" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </div>
    </div>

    <div class="overlay"></div>
    <div class="app-container">
        <aside class="sidebar">
            <h2>Stockist Menu</h2>
            <ul>
                <li><a href="#dashboard" class="nav-link active" data-section="dashboard-section"><i class="fas fa-chart-line"></i> BI Dashboard</a></li>
                <li><a href="#product-master" class="nav-link" data-section="product-master-section"><i class="fas fa-pills"></i> Product Catalog</a></li>
                <li><a href="#batch-master" class="nav-link" data-section="batch-master-section"><i class="fas fa-boxes"></i> Batch Info (View)</a></li>
                <li><a href="#pricing-catalogs" class="nav-link" data-section="pricing-catalogs-section"><i class="fas fa-tags"></i> My Pricing (View)</a></li>
                <li><a href="#place-order" class="nav-link" data-section="place-order-section"><i class="fas fa-shopping-cart"></i> Place New Order</a></li>
                <li><a href="#my-orders" class="nav-link" data-section="my-orders-section"><i class="fas fa-clipboard-check"></i> My Orders</a></li>
                <li><a href="#my-stock" class="nav-link" data-section="my-stock-section"><i class="fas fa-warehouse"></i> My Current Stock</a></li>
                <li><a href="#audit-trail" class="nav-link" data-section="audit-trail-section"><i class="fas fa-clipboard-list"></i> My Audit Log</a></li>
            </ul>
        </aside>

        <main class="main-content">
            <section id="dashboard-section" class="content-section active">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>Super Stockist Dashboard</h3>
                        <span class="info-icon" title="Key metrics for your stockist operations."><i class="fas fa-info-circle"></i></span>
                    </div>
                    <p><em>(This dashboard provides insights relevant to your Super Stockist operations: current inventory, orders placed, and sales data.)</em></p>
                    <div class="dashboard-grid">
                        <div class="dashboard-card metric-card">
                            <div class="card-header">
                                <h3>Total Orders Placed</h3>
                                <span class="info-icon" title="Total number of orders you have placed with the CFA."><i class="fas fa-info-circle"></i></span>
                            </div>
                            <div class="card-content">
                                <p class="main-metric" id="total-orders-placed">...</p>
                                <div class="metric-description">With CFA/Manufacturer.</div>
                            </div>
                        </div>
                        <div class="dashboard-card metric-card">
                            <div class="card-header">
                                <h3>My Current Stock Value</h3>
                                <span class="info-icon" title="Estimated value of inventory currently at your Super Stockist location."><i class="fas fa-info-circle"></i></span>
                            </div>
                            <div class="card-content">
                                <p class="main-metric" id="stockist-stock-value">...</p>
                                <div class="metric-description">Based on available inventory.</div>
                            </div>
                        </div>
                        <div class="dashboard-card alert-card warning">
                            <span class="alert-icon"><i class="fas fa-exclamation-triangle"></i></span>
                            <p><strong>Alert:</strong> High demand expected for **Product X** next week. Current stock is low (10 units)!</p>
                        </div>
                        <div class="dashboard-card chart-card">
                            <div class="card-header">
                                <h3>My Monthly Sales Trends</h3>
                                <span class="info-icon" title="Your sales performance over the past few months."><i class="fas fa-info-circle"></i></span>
                            </div>
                            <div class="chart-container">
                                <canvas id="stockistSalesChart"></canvas>
                                <p class="sr-only">Stockist sales chart placeholder</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="product-master-section" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <h3>Product Catalog</h3>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Product ID</th>
                                    <th>Name</th>
                                    <th>Description</th>
                                    <th>HSN</th>
                                    <th>GST%</th>
                                    <th>Composition</th>
                                    <th>Category</th>
                                </tr>
                            </thead>
                            <tbody id="stockistProductTableBody">
                                <!-- Dynamic rows inserted via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="batch-master-section" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <h3>Batch Information (View Only)</h3>
                    </div>
                     <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Batch No</th>
                                    <th>Product ID</th>
                                    <th>Mfg Date</th>
                                    <th>Exp Date</th>
                                    <th>MRP</th>
                                    <th>Quantity (Approx. CFA)</th>
                                </tr>
                            </thead>
                            <tbody id="stockistBatchTableBody">
                                <tr>
                                    <td>B001XYZ</td>
                                    <td>PROD001</td>
                                    <td>2024-01-15</td>
                                    <td>2026-01-14</td>
                                    <td>50.00</td>
                                    <td>5000</td>
                                </tr>
                                <tr>
                                    <td>B002ABC</td>
                                    <td>PROD002</td>
                                    <td>2024-03-01</td>
                                    <td>2026-03-01</td>
                                    <td>80.00</td>
                                    <td>2000</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <section id="pricing-catalogs-section" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <h3>My Pricing (View Only)</h3>
                    </div>
                    <div class="filter-bar">
                        <label for="pricingStateRegionStockist" class="sr-only">Select State/Region:</label>
                        <select id="pricingStateRegionStockist">
                            <option value="all">My Region</option>
                            <option value="MH">Maharashtra</option>
                            <option value="KA">Karnataka</option>
                        </select>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Product ID</th>
                                    <th>Product Name</th>
                                    <th>State/Region</th>
                                    <th>Price (PTR)</th>
                                    <th>Price (PTS)</th>
                                    <th>Effective Date</th>
                                </tr>
                            </thead>
                            <tbody id="stockistPricingTableBody">
                                <tr>
                                    <td>PROD001</td>
                                    <td>Paracetamol 500mg</td>
                                    <td>Maharashtra</td>
                                    <td>35.00</td>
                                    <td>40.00</td>
                                    <td>2024-04-01</td>
                                </tr>
                                <tr>
                                    <td>PROD002</td>
                                    <td>Amoxicillin 250mg</td>
                                    <td>Maharashtra</td>
                                    <td>70.00</td>
                                    <td>75.00</td>
                                    <td>2024-05-01</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="place-order-section" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <h3>Place New Order to CFA</h3>
                    </div>
                    <form id="placeOrderForm">
                        <div class="form-group">
                            <label for="orderProductId">Product:</label>
                            <select id="orderProductId" required></select>
                        </div>
                        <div class="form-group">
                            <label for="orderQuantity">Quantity:</label>
                            <input type="number" id="orderQuantity" min="1" required>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-success"><i class="fas fa-plus-circle"></i> Place Order</button>
                        </div>
                    </form>
                </div>
            </section>

            <section id="my-orders-section" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <h3>My Placed Orders</h3>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>To CFA</th>
                                    <th>Product</th>
                                    <th>Quantity</th>
                                    <th>Order Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="myOrdersTableBody">
                                <!-- Dynamic rows inserted via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="my-stock-section" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <h3>My Current Stock (Super Stockist Location)</h3>
                    </div>
                    <div class="filter-bar">
                        <input type="text" placeholder="Search Product/Batch..." aria-label="Search product or batch">
                        <select aria-label="Filter by Product Category">
                            <option>Filter by Category</option>
                            <option>Analgesic</option>
                            <option>Antibiotic</option>
                        </select>
                        <button class="btn btn-primary btn-sm"><i class="fas fa-filter"></i> Apply Filters</button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Product Name</th>
                                    <th>Batch No</th>
                                    <th>Quantity</th>
                                    <th>Expiry Date</th>
                                    <th>Last Updated</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="stockistMyStockTableBody">
                                <!-- Dynamic rows inserted via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="audit-trail-section" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <h3>My Audit Log</h3>
                    </div>
                    <div class="filter-bar">
                        <label for="auditStartDateStockist" class="sr-only">Start Date:</label>
                        <input type="date" id="auditStartDateStockist" aria-label="Audit start date">
                        <label for="auditEndDateStockist" class="sr-only">End Date:</label>
                        <input type="date" id="auditEndDateStockist" aria-label="Audit end date">
                        <select id="auditActionFilterStockist" aria-label="Filter by Action Type">
                            <option value="">Filter by Action Type</option>
                            <option value="Order Placed">Order Placed</option>
                            <option value="Stock Received">Stock Received</option>
                        </select>
                        <button class="btn btn-primary btn-sm"><i class="fas fa-search"></i> Filter Logs</button>
                        <button class="btn btn-secondary btn-sm"><i class="fas fa-file-export"></i> Export Report</button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Timestamp</th>
                                    <th>User</th>
                                    <th>Action</th>
                                    <th>Entity</th>
                                    <th>Entity ID</th>
                                    <th>Details</th>
                                    <th>IP Address</th>
                                </tr>
                            </thead>
                            <tbody id="stockistAuditLogTableBody">
                                <tr>
                                    <td>2025-06-20 09:00:00</td>
                                    <td>StockistUser</td>
                                    <td>Order Placed</td>
                                    <td>Order</td>
                                    <td>ORD101</td>
                                    <td>Placed order for Paracetamol 200 units to CFA01</td>
                                    <td>192.168.1.20</td>
                                </tr>
                                <tr>
                                    <td>2025-06-18 16:00:00</td>
                                    <td>StockistUser</td>
                                    <td>Stock Received</td>
                                    <td>Batch</td>
                                    <td>B002ABC</td>
                                    <td>Received 50 units of Amoxicillin from CFA01</td>
                                    <td>192.168.1.20</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- Modals for Stockist Specific actions -->

    <!-- Place Order Modal (no separate modal, directly integrated into section for simplicity) -->
    <!-- The form for "Place New Order to CFA" is directly in the section id="place-order-section" -->

    <nav class="bottom-nav">
        <a href="#dashboard" class="bottom-nav-item active" data-section="dashboard-section">
            <i class="fas fa-chart-line"></i>
            <span>Dashboard</span>
        </a>
        <a href="#place-order" class="bottom-nav-item" data-section="place-order-section">
            <i class="fas fa-shopping-cart"></i>
            <span>Order</span>
        </a>
        <a href="#my-orders" class="bottom-nav-item" data-section="my-orders-section">
            <i class="fas fa-clipboard-check"></i>
            <span>My Orders</span>
        </a>
        <a href="#my-stock" class="bottom-nav-item" data-section="my-stock-section">
            <i class="fas fa-warehouse"></i>
            <span>My Stock</span>
        </a>
        <a href="#audit-trail" class="bottom-nav-item" data-section="audit-trail-section">
            <i class="fas fa-clipboard-list"></i>
            <span>Audit</span>
        </a>
    </nav>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <script>
        let token = '';
        // Basic JS for sidebar navigation and modal placeholders
        document.addEventListener('DOMContentLoaded', function () {
            token = localStorage.getItem('token');
            const userRole = localStorage.getItem('role');
            if (!token || userRole !== 'super_stockist') {
                window.location.href = 'index.html';
                return;
            }

            const navLinks = document.querySelectorAll('.sidebar .nav-link');
            const bottomNavItems = document.querySelectorAll('.bottom-nav-item');
            const contentSections = document.querySelectorAll('.main-content .content-section');
            const menuToggle = document.querySelector('.menu-toggle');
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.querySelector('.overlay');

            function activateSection(targetSectionId) {
                contentSections.forEach(section => {
                    if (section.id === targetSectionId) {
                        section.classList.add('active');
                    } else {
                        section.classList.remove('active');
                    }
                });
            }

            function setActiveNavLink(dataSection) {
                 navLinks.forEach(nav => {
                    if (nav.getAttribute('data-section') === dataSection) {
                        nav.classList.add('active');
                    } else {
                        nav.classList.remove('active');
                    }
                });
                bottomNavItems.forEach(nav => {
                    if (nav.getAttribute('data-section') === dataSection) {
                        nav.classList.add('active');
                    } else {
                        nav.classList.remove('active');
                    }
                });
            }

            // Handle sidebar navigation clicks
            navLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetSectionId = this.getAttribute('data-section');
                    setActiveNavLink(targetSectionId);
                    activateSection(targetSectionId);
                    closeSidebar(); // Close sidebar after selection
                });
            });

            // Handle bottom navigation clicks
            bottomNavItems.forEach(item => {
                item.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetSectionId = this.getAttribute('data-section');
                    setActiveNavLink(targetSectionId);
                    activateSection(targetSectionId);
                });
            });

            // Toggle sidebar for mobile
            menuToggle.addEventListener('click', function() {
                toggleSidebar();
            });

            overlay.addEventListener('click', function() {
                closeSidebar();
            });

            function toggleSidebar() {
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
            }

            function closeSidebar() {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }

            // Initial section activation
            const initialSectionData = localStorage.getItem('stockistLastActiveSection') || 'dashboard-section';
            setActiveNavLink(initialSectionData);
            activateSection(initialSectionData);

            // Store last active section in local storage (for persistence)
            navLinks.forEach(link => {
                link.addEventListener('click', function() {
                    localStorage.setItem('stockistLastActiveSection', this.getAttribute('data-section'));
                });
            });
            bottomNavItems.forEach(item => {
                item.addEventListener('click', function() {
                    localStorage.setItem('stockistLastActiveSection', this.getAttribute('data-section'));
                });
            });

            // Logout functionality
            document.getElementById('logout-btn').addEventListener('click', function(e) {
                e.preventDefault();
                localStorage.removeItem('token');
                localStorage.removeItem('role');
                localStorage.removeItem('stockistLastActiveSection'); // Clear Stockist specific state
                window.location.href = 'index.html'; // Redirect to login/home page
            });

            fetchProducts();
            fetchOrders();
            loadStockistBatches();
            loadStockistPricing();
            loadStockistMyStock();
            loadStockistAuditLogs();
        });

        // Modals are not used for Stockist in this simplified version, as forms are directly on page sections.
        // Keeping dummy open/close functions for consistency with original template if needed later.
        function openModal(modalId) {
            // No modals for stockist, forms are inline
            console.log(`Open modal function called for ${modalId}, but stockist forms are inline.`);
        }

        function closeModal(modalId) {
            console.log(`Close modal function called for ${modalId}, but stockist forms are inline.`);
        }

        // Mock API Calls and Data Loading for Super Stockist Dashboard
        const dummyStockistData = {
            products: [],
            batches: [
                { id: 'B001XYZ', product_id: 'PROD001', mfg_date: '2024-01-15', exp_date: '2026-01-14', mrp: 50.00, quantity: 5000 }, // Qty here is approximate from CFA for view
                { id: 'B002ABC', product_id: 'PROD002', mfg_date: '2024-03-01', exp_date: '2026-03-01', mrp: 80.00, quantity: 2000 }
            ],
            pricing: [ // Stockist only sees relevant pricing for their region
                { product_id: 'PROD001', product_name: 'Paracetamol 500mg', state_region: 'Maharashtra', ptr: 35.00, pts: 40.00, effective_date: '2024-04-01' },
                { product_id: 'PROD002', product_name: 'Amoxicillin 250mg', state_region: 'Maharashtra', ptr: 70.00, pts: 75.00, effective_date: '2024-05-01' }
            ],
            myOrders: [],
            myStock: [
                { product_id: 'PROD001', product_name: 'Paracetamol 500mg', batch_no: 'B001XYZ', quantity: 150, exp_date: '2026-01-14', last_updated: '2025-06-20', status: 'Healthy' },
                { product_id: 'PROD002', product_name: 'Amoxicillin 250mg', batch_no: 'B002ABC', quantity: 30, exp_date: '2026-03-01', last_updated: '2025-06-20', status: 'Low Stock' },
                { product_id: 'PROD003', product_name: 'Antacid Liquid', batch_no: 'B003LMN', quantity: 80, exp_date: '2025-10-01', last_updated: '2025-06-20', status: 'Healthy' }
            ],
            auditLogs: [
                { timestamp: '2025-06-20 09:00:00', user: 'StockistUser', action: 'Order Placed', entity: 'Order', entity_id: 'ORD101', details: 'Placed order for Paracetamol 200 units to CFA01', ip_address: '192.168.1.20' },
                { timestamp: '2025-06-18 16:00:00', user: 'StockistUser', action: 'Stock Received', entity: 'Batch', entity_id: 'B002ABC', details: 'Received 50 units of Amoxicillin from CFA01', ip_address: '192.168.1.20' }
            ],
            mySales: [
                { month: 'Jan', sales: 5000 },
                { month: 'Feb', sales: 7500 },
                { month: 'Mar', sales: 6000 },
                { month: 'Apr', sales: 8000 },
                { month: 'May', sales: 9500 },
                { month: 'Jun', sales: 11000 }
            ]
        };

        async function fetchProducts() {
            const resp = await fetch('/api/products', { headers: { 'Authorization': `Bearer ${token}` } });
            const data = await resp.json();
            dummyStockistData.products = data;
            populateProductDropdownsStockist();
            loadStockistProducts();
        }

        async function fetchOrders() {
            const resp = await fetch('/api/orders', { headers: { 'Authorization': `Bearer ${token}` } });
            const data = await resp.json();
            dummyStockistData.myOrders = data;
            loadMyOrders();
        }

        // Populate dropdowns with products for order placement
        function populateProductDropdownsStockist() {
            const productSelect = document.getElementById('orderProductId');
            if (productSelect) {
                productSelect.innerHTML = '';
                dummyStockistData.products.forEach(p => {
                    const option = document.createElement('option');
                    option.value = p.name;
                    option.textContent = p.name;
                    productSelect.appendChild(option);
                });
            }
        }

        // Load Product Catalog (View Only for Stockist)
        function loadStockistProducts() {
            const body = document.getElementById('stockistProductTableBody');
            if (!body) return;
            body.innerHTML = '';
            dummyStockistData.products.forEach(p => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${p.id}</td>
                    <td>${p.name}</td>
                    <td>${p.description || ''}</td>
                    <td>${p.hsn || ''}</td>
                    <td>${p.gst || ''}</td>
                    <td>${p.composition || ''}</td>
                    <td>${p.category || ''}</td>
                `;
                body.appendChild(row);
            });
        }

        // Load Batch Information (View Only for Stockist)
        function loadStockistBatches() {
            const body = document.getElementById('stockistBatchTableBody');
            if (!body) return;
            body.innerHTML = '';
            dummyStockistData.batches.forEach(b => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${b.id}</td>
                    <td>${b.product_id}</td>
                    <td>${b.mfg_date || ''}</td>
                    <td>${b.exp_date || ''}</td>
                    <td>${b.mrp.toFixed(2) || ''}</td>
                    <td>${b.quantity || ''}</td>
                `;
                body.appendChild(row);
            });
        }

        // Load Pricing (View Only for Stockist)
        function loadStockistPricing() {
            const body = document.getElementById('stockistPricingTableBody');
            if (!body) return;
            body.innerHTML = '';
            dummyStockistData.pricing.forEach(p => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${p.product_id}</td>
                    <td>${p.product_name}</td>
                    <td>${p.state_region}</td>
                    <td>${p.ptr.toFixed(2)}</td>
                    <td>${p.pts.toFixed(2)}</td>
                    <td>${p.effective_date}</td>
                `;
                body.appendChild(row);
            });
        }

        // Load My Placed Orders (Stockist to CFA)
        async function loadMyOrders() {
            const body = document.getElementById('myOrdersTableBody');
            if (!body) return;
            const resp = await fetch('/api/orders', { headers: { 'Authorization': `Bearer ${token}` } });
            const data = await resp.json();
            dummyStockistData.myOrders = data;
            body.innerHTML = '';
            data.forEach(o => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${o.id}</td>
                    <td>-</td>
                    <td>${o.product}</td>
                    <td>${o.quantity}</td>
                    <td>-</td>
                    <td>${o.status}</td>
                `;
                body.appendChild(row);
            });
            document.getElementById('total-orders-placed').textContent = data.length;
        }

        // Load Stockist's Own Stock
        function loadStockistMyStock() {
            const body = document.getElementById('stockistMyStockTableBody');
            if (!body) return;
            body.innerHTML = '';
            dummyStockistData.myStock.forEach(s => {
                const row = document.createElement('tr');
                let statusColor = 'inherit';
                if (s.status === 'Low Stock') statusColor = '#ffc107';
                row.innerHTML = `
                    <td>${s.product_name}</td>
                    <td>${s.batch_no}</td>
                    <td>${s.quantity}</td>
                    <td>${s.exp_date || ''}</td>
                    <td>${s.last_updated || ''}</td>
                    <td style="color:${statusColor}; font-weight: 500;">${s.status}</td>
                `;
                body.appendChild(row);
            });
        }

        // Load Audit Logs for Stockist
        function loadStockistAuditLogs() {
            const body = document.getElementById('stockistAuditLogTableBody');
            if (!body) return;
            body.innerHTML = '';
            dummyStockistData.auditLogs.forEach(log => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${log.timestamp}</td>
                    <td>${log.user}</td>
                    <td>${log.action}</td>
                    <td>${log.entity}</td>
                    <td>${log.entity_id}</td>
                    <td>${log.details}</td>
                    <td>${log.ip_address}</td>
                `;
                body.appendChild(row);
            });
        }

        // Form submissions
        document.getElementById('placeOrderForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const product = document.getElementById('orderProductId').value;
            const quantity = document.getElementById('orderQuantity').value;
            const resp = await fetch('/api/orders', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                },
                body: JSON.stringify({ product, quantity: parseInt(quantity) })
            });
            if (resp.ok) {
                await loadMyOrders();
                alert('Order placed successfully');
            } else {
                const data = await resp.json();
                alert(data.error || 'Failed to place order');
            }
        });




        // Placeholder for chart rendering on Stockist dashboard
        function renderStockistCharts() {
            // Simulate data for dashboard charts
            const stockistSalesCtx = document.getElementById('stockistSalesChart');
            if (stockistSalesCtx) {
                const salesData = dummyStockistData.mySales;
                new Chart(stockistSalesCtx, {
                    type: 'line',
                    data: {
                        labels: salesData.map(d => d.month),
                        datasets: [{
                            label: 'Monthly Sales ($)',
                            data: salesData.map(d => d.sales),
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.2)',
                            tension: 0.1,
                            fill: true
                        }]
                    },
                    options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true } }, plugins: { legend: { position: 'bottom' } } }
                });
            }

            // Update dummy metrics
            document.getElementById('total-orders-placed').textContent = dummyStockistData.myOrders.length;
            const totalStockValue = dummyStockistData.myStock.reduce((sum, item) => {
                const product = dummyStockistData.products.find(p => p.id === item.product_id);
                return sum + (product ? product.price * item.quantity : 0);
            }, 0);
            document.getElementById('stockist-stock-value').textContent = `$${totalStockValue.toFixed(2)}`;
        }

        document.addEventListener('DOMContentLoaded', renderStockistCharts); // Render charts after all content is loaded
    </script>
</body>
</html>
